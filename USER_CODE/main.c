/****************************************Copyright (c)****************************************************
**                            Guangzhou ZLGMCU Development Co., LTD
**
**                                 http://www.zlgmcu.com
**
**--------------File Info---------------------------------------------------------------------------------
** File name:           main.c
** Last modified Date:  2010-02-04
** Last Version:        V1.0
** Descriptions:        The main() function example template
**
**--------------------------------------------------------------------------------------------------------
** Created by:          Li Baihua
** Created date:        2010-09-10
** Version:             V1.00
** Descriptions:        整理模板，添加用户应用程序
**
**--------------------------------------------------------------------------------------------------------
** Modified by:         
** Modified date:       
** Version:             
** Descriptions:        
**
**--------------------------------------------------------------------------------------------------------
** Modified by:        
** Modified date:      
** Version:            
** Descriptions:       
**
** Rechecked by:
*********************************************************************************************************/
#include "LPC11xx.h"                                                    /* LPC11xx外设寄存器            */

/*********************************************************************************************************
  宏定义
*********************************************************************************************************/
#define LED_NUM      4
/*********************************************************************************************************
  全局变量
*********************************************************************************************************/
const uint32_t led_mask[] = {1 << 0, 1 << 1, 1 << 2, 1 << 3, 1 << 4, 1 << 5, 1 << 6, 1 << 7 };

/*********************************************************************************************************
** Function name:       myDelay
** Descriptions:        软件延时
** input parameters:    无
** output parameters:   无
** Returned value:      无
*********************************************************************************************************/
void myDelay (uint32_t ulTime)
{
    uint32_t i;

    i = 0;
    while (ulTime--) {
        for (i = 0; i < 5000; i++);
    }
}

/*********************************************************************************************************
** Function name:       GPIOInit
** Descriptions:        GPIO初始化
** input parameters:    无
** output parameters:   无
** Returned value:      无
*********************************************************************************************************/
void GPIOInit( void )
{
    LPC_SYSCON->SYSAHBCLKCTRL |= (1 << 6);                              /* 初始化GPIO AHB时钟           */
    LPC_IOCON->PIO2_8 &= ~0x07;                                         /* 将P2.8-11初始化为GPIO功能    */
    LPC_IOCON->PIO2_9 &= ~0x07;
    LPC_IOCON->PIO2_10&= ~0x07;
    LPC_IOCON->PIO2_11&= ~0x07;
    LPC_GPIO2->DIR    |= 0x0F << 8;                                     /* 将P2.8-11方向设置为输出      */
}

/*********************************************************************************************************
** Function name:       main
** Descriptions:        LED例程。
**                      跳线连接：P2.8~P2.11分别与LED1~LED4控制引脚短接；
**                      现    象：下载代码，运行程序。LED先从LED1至LED4依次闪烁一次，
**                                再从LED4至LED1依次闪烁一次，如此重复。
** input parameters:    无
** output parameters:   无
** Returned value:      无
*********************************************************************************************************/
int main(void)
{
   int32_t num = -1;
   int32_t dir =  1;

   SystemInit();                                                        /* 初始化目标板，切勿删除       */
   GPIOInit();

   while (1) {  
       num += dir;
       if (num == LED_NUM) {
           dir = -1;
           num =  LED_NUM - 1; 
       } else if (num < 0) {
           dir =  1;
           num =  0;
       }
       LPC_GPIO2->DATA &= ~(led_mask[num] << 8);
       myDelay(200);
       LPC_GPIO2->DATA |=  (led_mask[num] << 8);
       myDelay(200);
   }
}

/*********************************************************************************************************
  End Of File
*********************************************************************************************************/
